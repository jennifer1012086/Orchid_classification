{"cells":[{"metadata":{"_uuid":"77c9b4cc1efaa0a4544f0e8ae2844264df1f0e90","id":"J8T9IDvOG324"},"cell_type":"markdown","source":["<a id=\"content1\"></a>\n","## 1 ) Importing Various Modules."]},{"cell_type":"code","source":["!pip install keras"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"geEGQ0d7L07k","executionInfo":{"status":"ok","timestamp":1654864644594,"user_tz":-480,"elapsed":3152,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}},"outputId":"65baa81f-6c7c-425e-9afb-8fd599b88abd"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: keras in /usr/local/lib/python3.7/dist-packages (2.8.0)\n"]}]},{"metadata":{"id":"z19bVm7o9zeu","trusted":true,"_uuid":"4902ee7b7f4d66a42d59b971180bba213d0133c9","executionInfo":{"status":"ok","timestamp":1654864650601,"user_tz":-480,"elapsed":3014,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}}},"cell_type":"code","source":["# Ignore  the warnings\n","import warnings\n","warnings.filterwarnings('always')\n","warnings.filterwarnings('ignore')\n","\n","# data visualisation and manipulation\n","import numpy as np\n","import pandas as pd\n","import matplotlib.pyplot as plt\n","from matplotlib import style\n","import seaborn as sns\n"," \n","#configure\n","# sets matplotlib to inline and displays graphs below the corressponding cell.\n","%matplotlib inline  \n","style.use('fivethirtyeight')\n","sns.set(style='whitegrid',color_codes=True)\n","\n","#model selection\n","from sklearn.model_selection import train_test_split\n","from sklearn.model_selection import KFold\n","from sklearn.metrics import accuracy_score,precision_score,recall_score,confusion_matrix,roc_curve,roc_auc_score\n","from sklearn.model_selection import GridSearchCV\n","from sklearn.preprocessing import LabelEncoder\n","\n","#preprocess.\n","from keras.preprocessing.image import ImageDataGenerator\n","\n","#dl libraraies\n","from keras import backend as K\n","from keras.models import Sequential\n","from keras.layers import Dense\n","from tensorflow.keras.optimizers import Adam,SGD,Adagrad,Adadelta,RMSprop\n","from tensorflow.keras.utils import to_categorical, set_random_seed\n","from keras.callbacks import ReduceLROnPlateau\n","\n","# specifically for cnn\n","from keras.layers import Dropout, Flatten,Activation\n","from keras.layers import Conv2D, MaxPooling2D, BatchNormalization\n"," \n","import tensorflow as tf\n","import random as rn\n","\n","# specifically for manipulating zipped images and getting numpy arrays of pixel values of images.\n","import cv2                  \n","import numpy as np  \n","from tqdm import tqdm\n","import os                   \n","from random import shuffle  \n","from zipfile import ZipFile\n","from PIL import Image\n","\n","#TL pecific modules\n","from keras.applications.vgg16 import VGG16\n","from tensorflow.keras.applications.resnet50 import ResNet50"],"execution_count":2,"outputs":[]},{"metadata":{"_uuid":"1fa0f050be4d3796a3253bc22c0d87393d55902a","id":"htUFKaOLG33E"},"cell_type":"markdown","source":["<a id=\"content2\"></a>\n","## 2 ) Preparing the Data"]},{"metadata":{"_uuid":"192e68db5329da0e491aba8f12a6ca5cda534ce9","id":"567F79KPG33G"},"cell_type":"markdown","source":["## 2.1) Making the functions to get the training and validation set from the Images"]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"zWV8jTSCKtD4","executionInfo":{"status":"ok","timestamp":1654864678353,"user_tz":-480,"elapsed":25555,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}},"outputId":"9d857a4a-ab28-4154-c4e6-f507c9298550"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"metadata":{"id":"abZS8dPk9ze1","trusted":true,"_uuid":"7b0c13e69deaf6449739ba2104bb6238be376f05","executionInfo":{"status":"ok","timestamp":1654864681091,"user_tz":-480,"elapsed":369,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}}},"cell_type":"code","source":["X=[]\n","Z=[]\n","IMG_SIZE=150\n","DIR='/content/drive/MyDrive/大四(下)/機器學習/orchid/training/train/'\n","weights_path='/content/drive/MyDrive/大四(下)/機器學習/orchid/vgg16_weights_tf_dim_ordering_tf_kernels_notop.h5'"],"execution_count":4,"outputs":[]},{"metadata":{"id":"2qPgwo1d9ze4","trusted":true,"_uuid":"1c467392d43ee29671c5498bd1feea5db5ef862d","executionInfo":{"status":"ok","timestamp":1654864684492,"user_tz":-480,"elapsed":3,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}}},"cell_type":"code","source":["def assign_label(img,flower_type):\n","    return flower_type"],"execution_count":5,"outputs":[]},{"metadata":{"id":"vlY8PywM9ze7","trusted":true,"_uuid":"861b4e251d97f7601a3bc2c3077183de4122e3d9","executionInfo":{"status":"ok","timestamp":1654864686543,"user_tz":-480,"elapsed":2,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}}},"cell_type":"code","source":["def make_train_data(flower_type,DIR):\n","    for img in tqdm(os.listdir(DIR)):\n","        label=assign_label(img,flower_type)\n","        path = os.path.join(DIR,img)\n","        img = cv2.imread(path,cv2.IMREAD_COLOR)\n","        img = cv2.resize(img, (IMG_SIZE,IMG_SIZE))\n","        \n","        X.append(np.array(img))\n","        Z.append(int(label))"],"execution_count":6,"outputs":[]},{"cell_type":"code","source":["for i in range(219):\n","    make_train_data(str(i), DIR+str(i))"],"metadata":{"id":"W_xdIzIEI5j5","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1654866016335,"user_tz":-480,"elapsed":1326773,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}},"outputId":"2cb3cfa7-c320-4a4d-889c-975e4085c22a"},"execution_count":7,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 10/10 [00:05<00:00,  1.70it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.71it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.73it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.74it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.57it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.78it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.83it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.49it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.72it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.82it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.55it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.74it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.60it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.69it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.63it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.74it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.70it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.66it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.78it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.94it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.66it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.70it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.90it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.70it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.72it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.71it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.79it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.72it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.60it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.69it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.49it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.63it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.81it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.71it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.82it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.67it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.81it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.65it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.63it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.76it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.70it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.61it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.63it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.69it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.53it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.67it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.53it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.49it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.67it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.66it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.55it/s]\n","100%|██████████| 10/10 [00:08<00:00,  1.23it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.63it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.83it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.65it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.64it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.72it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.45it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.68it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.55it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.51it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.71it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.59it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.78it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.96it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.71it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.69it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.56it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.63it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.80it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.68it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.70it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.76it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.79it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.68it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.72it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.55it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.67it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.58it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.50it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.67it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.61it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.49it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.63it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.64it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.74it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.70it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.68it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.72it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.71it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.81it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.54it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.59it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.65it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.61it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.72it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.63it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.73it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.74it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.67it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.75it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.78it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.64it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.71it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.51it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.48it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.84it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.78it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.49it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.73it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.79it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.71it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.93it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.73it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.60it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.76it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.79it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.81it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.63it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.59it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.71it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.75it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.96it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.76it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.69it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.99it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.71it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.61it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.74it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.67it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.80it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.75it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.75it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.66it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.81it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.64it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.63it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.67it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.87it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.70it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.80it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.72it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.70it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.71it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.67it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.60it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.79it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.76it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.70it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.65it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.52it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.67it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.72it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.57it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.57it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.84it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.85it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.68it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.77it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.60it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.80it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.65it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.65it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.57it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.60it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.75it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.77it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.56it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.63it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.75it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.73it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.67it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.72it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.66it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.66it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.75it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.62it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.74it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.65it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.73it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.66it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.66it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.72it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.60it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.76it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.77it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.59it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.57it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.71it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.73it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.66it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.65it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.71it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.71it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.83it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.93it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.72it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.75it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.68it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.67it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.77it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.77it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.67it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.54it/s]\n","100%|██████████| 10/10 [00:09<00:00,  1.02it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.73it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.72it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.75it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.66it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.78it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.86it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.74it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.71it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.74it/s]\n","100%|██████████| 10/10 [00:08<00:00,  1.13it/s]\n","100%|██████████| 10/10 [00:05<00:00,  1.77it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.51it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.62it/s]\n","100%|██████████| 10/10 [00:06<00:00,  1.65it/s]\n"]}]},{"metadata":{"_uuid":"963b723dd10cb918fa045588a5dfa07d55007db3","id":"jS4B1HDpG33U"},"cell_type":"markdown","source":["## 2.3 ) One Hot Encoding "]},{"metadata":{"id":"_Gug0CHU9zfe","trusted":true,"_uuid":"1f006ba66f46d8c3355ecdd3b27b37bdea635944","executionInfo":{"status":"ok","timestamp":1654866189201,"user_tz":-480,"elapsed":955,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}}},"cell_type":"code","source":["Y=to_categorical(Z,219)\n","X=np.array(X)\n","X=X/255"],"execution_count":8,"outputs":[]},{"metadata":{"_uuid":"d6a8f93a1446fa61e9c89a61be3a0fbb4328ad15","id":"rn4A7IWcG33W"},"cell_type":"markdown","source":["## 2.4 ) Splitting into Training and Validation Sets"]},{"metadata":{"id":"4xogXfvm9zfg","trusted":true,"_uuid":"e9b04ed0a732e99941d6a347a14d66eb2cb4727b","executionInfo":{"status":"ok","timestamp":1654866192958,"user_tz":-480,"elapsed":409,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}}},"cell_type":"code","source":["x_train,x_test,y_train,y_test=train_test_split(X,Y,test_size=0.25,random_state=42)"],"execution_count":9,"outputs":[]},{"metadata":{"_uuid":"10556b8fcdde09321078b4fa4df9e9dc651f877a","id":"rrPlhVbHG33Y"},"cell_type":"markdown","source":["## 2.5 ) Setting the Random Seeds"]},{"metadata":{"id":"S_nM3vLf9zfj","trusted":true,"_uuid":"f0e2ae22e3bca8e3143d5b4d312460283b833878","executionInfo":{"status":"ok","timestamp":1654866196338,"user_tz":-480,"elapsed":412,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}}},"cell_type":"code","source":["np.random.seed(42)\n","rn.seed(42)\n","set_random_seed(42)"],"execution_count":10,"outputs":[]},{"metadata":{"_uuid":"82aa7c88a3fac8f8596ce70653900664f2b61ad4","id":"7EZFTVJwG33Z"},"cell_type":"markdown","source":["<a id=\"content3\"></a>\n","## 3 ) Modelling"]},{"metadata":{"_uuid":"550936cbbc153229adb624c2c31050c5d93c2a8e","id":"hN7rVC-BG33a"},"cell_type":"markdown","source":["## 3.1 ) Specifying the Base Model"]},{"metadata":{"_uuid":"42730871d9f28580dab21b9e15c6b65c67e8a5e6","id":"ejeb86pVG33b"},"cell_type":"markdown","source":["Transfer learning refers to using a pretrained model on some other task for your own task. Hence we need to specify the particular model which we are deploying in our task and thus needs to specify the base model.\n","\n","In our case we are using the VGG16 model from the Keras.Applications library as the base model."]},{"metadata":{"id":"SERVVhIgkxXV","trusted":true,"_uuid":"33b31b3df570b37c968f4c4e81ea24b48c864caa","executionInfo":{"status":"ok","timestamp":1654866203414,"user_tz":-480,"elapsed":4163,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}}},"cell_type":"code","source":["base_model=VGG16(include_top=False, weights=None,input_shape=(150,150,3), pooling='avg')\n","# base_model=ResNet50(include_top=False, weights=\"imagenet\",input_shape=(256, 256,3), pooling='avg') "],"execution_count":11,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"9155aceff9ad2d42cbd5b9151389d2f15e8c7abd","id":"AZq6vdaBG33c","executionInfo":{"status":"ok","timestamp":1654866207502,"user_tz":-480,"elapsed":2355,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}}},"cell_type":"code","source":["base_model.load_weights(weights_path)"],"execution_count":12,"outputs":[]},{"metadata":{"_uuid":"0113e4773b50a6aa8434865fe1657d6859d25d71","id":"HVnHjj1cG33d"},"cell_type":"markdown","source":["#### BREAKING IT DOWN--\n","\n","1) Firstly we import the VGG16 module from the Keras library.\n","\n","2) Next we need to specify if we want  to use the fully connected layers of the VGG16 module or own layers. Since our task is different and we have only 5 target classes we need to have our own layers and I have specified the 'include_top' arguement as 'False'.\n","\n","3) Next we need to specify the weights to be used by the model. Since I want it to use the weights it was trained on in ImageNet competition, I have loaded the weights from the corressponding file. You can directly specify the weights arguement as 'imagenet' in VGG16( )  but it didn't work in my case so I have to explicitily load the weghts from a file.\n"," \n","4) Lastly we just need to specify the shape of the imput that our model need to expect and also specify the 'pooling' type."]},{"metadata":{"id":"xHOoktp-k4tw","trusted":true,"_uuid":"3bca9ce0ba74b4bec90b228d7805ce6d64e00062","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1654866211106,"user_tz":-480,"elapsed":471,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}},"outputId":"4adb8e3e-c579-4d8c-ad14-b144386eb958"},"cell_type":"code","source":["base_model.summary()"],"execution_count":13,"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"vgg16\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," input_1 (InputLayer)        [(None, 150, 150, 3)]     0         \n","                                                                 \n"," block1_conv1 (Conv2D)       (None, 150, 150, 64)      1792      \n","                                                                 \n"," block1_conv2 (Conv2D)       (None, 150, 150, 64)      36928     \n","                                                                 \n"," block1_pool (MaxPooling2D)  (None, 75, 75, 64)        0         \n","                                                                 \n"," block2_conv1 (Conv2D)       (None, 75, 75, 128)       73856     \n","                                                                 \n"," block2_conv2 (Conv2D)       (None, 75, 75, 128)       147584    \n","                                                                 \n"," block2_pool (MaxPooling2D)  (None, 37, 37, 128)       0         \n","                                                                 \n"," block3_conv1 (Conv2D)       (None, 37, 37, 256)       295168    \n","                                                                 \n"," block3_conv2 (Conv2D)       (None, 37, 37, 256)       590080    \n","                                                                 \n"," block3_conv3 (Conv2D)       (None, 37, 37, 256)       590080    \n","                                                                 \n"," block3_pool (MaxPooling2D)  (None, 18, 18, 256)       0         \n","                                                                 \n"," block4_conv1 (Conv2D)       (None, 18, 18, 512)       1180160   \n","                                                                 \n"," block4_conv2 (Conv2D)       (None, 18, 18, 512)       2359808   \n","                                                                 \n"," block4_conv3 (Conv2D)       (None, 18, 18, 512)       2359808   \n","                                                                 \n"," block4_pool (MaxPooling2D)  (None, 9, 9, 512)         0         \n","                                                                 \n"," block5_conv1 (Conv2D)       (None, 9, 9, 512)         2359808   \n","                                                                 \n"," block5_conv2 (Conv2D)       (None, 9, 9, 512)         2359808   \n","                                                                 \n"," block5_conv3 (Conv2D)       (None, 9, 9, 512)         2359808   \n","                                                                 \n"," block5_pool (MaxPooling2D)  (None, 4, 4, 512)         0         \n","                                                                 \n"," global_average_pooling2d (G  (None, 512)              0         \n"," lobalAveragePooling2D)                                          \n","                                                                 \n","=================================================================\n","Total params: 14,714,688\n","Trainable params: 14,714,688\n","Non-trainable params: 0\n","_________________________________________________________________\n"]}]},{"metadata":{"_uuid":"33a8724542cdac2b9002fbbd3db0400ebedcac0d","id":"OEJxjmRCG33f"},"cell_type":"markdown","source":["Note that this is NOT the summary of our model and this is the summary or the ARCHITECTURE of the VGG16 model that we are deploying as the base model."]},{"metadata":{"_uuid":"fe17a74b47da287a0b8763096d1e47beac1be85f","id":"gV0rfiEMG33g"},"cell_type":"markdown","source":["## 3.2 ) Adding our Own Fully Connected Layers"]},{"metadata":{"_uuid":"c1285074e54048895fa46f28ce94327dcb1fd2a7","id":"5-QKTQ91G33g"},"cell_type":"markdown","source":["Now we need to add at the top of the base model some fully connected layers. Alsowe can use the BatchNormalization and the Dropout layers as usual in case we want to.\n","\n","For this I have used a Keras sequential model and build our entire model on top of it; comprising of the VGG model as the base model + our own fully connected layers."]},{"metadata":{"id":"gGgMscM_eIYS","trusted":true,"_uuid":"61461000564043bcdd7dcafc2f99bf931eaecfa0","executionInfo":{"status":"ok","timestamp":1654866216100,"user_tz":-480,"elapsed":390,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}}},"cell_type":"code","source":["model=Sequential()\n","model.add(base_model)\n","\n","model.add(Dense(256,activation='relu'))\n","model.add(Dense(219,activation='softmax'))"],"execution_count":14,"outputs":[]},{"metadata":{"_uuid":"3d14eeca7ad5f8e01a4d868a2dda5dc4111387fb","id":"jqLmmgFBG33i"},"cell_type":"markdown","source":["## 3.3 ) Data Augmentation to prevent Overfitting"]},{"metadata":{"id":"lH038cfsgkvZ","trusted":true,"_uuid":"5859d726c293f373e7ee955bb931bd28f39db8d5","executionInfo":{"status":"ok","timestamp":1654866220725,"user_tz":-480,"elapsed":985,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}}},"cell_type":"code","source":["datagen = ImageDataGenerator(\n","        featurewise_center=False,  # set input mean to 0 over the dataset\n","        samplewise_center=False,  # set each sample mean to 0\n","        featurewise_std_normalization=False,  # divide inputs by std of the dataset\n","        samplewise_std_normalization=False,  # divide each input by its std\n","        zca_whitening=False,  # apply ZCA whitening\n","        rotation_range=10,  # randomly rotate images in the range (degrees, 0 to 180)\n","        zoom_range = 0.1, # Randomly zoom image \n","        width_shift_range=0.2,  # randomly shift images horizontally (fraction of total width)\n","        height_shift_range=0.2,  # randomly shift images vertically (fraction of total height)\n","        horizontal_flip=True,  # randomly flip images\n","        vertical_flip=False)  # randomly flip images\n","\n","\n","datagen.fit(X)"],"execution_count":15,"outputs":[]},{"metadata":{"_uuid":"fe28d78ca7d6f7af58b8bbaa6c4cf6a377f725b5","id":"qHp0nGnfG33j"},"cell_type":"markdown","source":["## 3.4 ) Using a Learning Rate Annealer & the Summary"]},{"metadata":{"id":"B_6-fsX6gky4","trusted":true,"_uuid":"0953cdcd6425381a3551aeb28af6c4b61654849d","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1654866224910,"user_tz":-480,"elapsed":415,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}},"outputId":"a9a5e3d2-6bce-409f-fa26-5c7c6b9e74f1"},"cell_type":"code","source":["epochs=50\n","batch_size=128\n","red_lr=ReduceLROnPlateau(monitor='val_acc', factor=0.1, epsilon=0.0001, patience=2, verbose=1)"],"execution_count":16,"outputs":[{"output_type":"stream","name":"stdout","text":["WARNING:tensorflow:`epsilon` argument is deprecated and will be removed, use `min_delta` instead.\n"]}]},{"metadata":{"id":"IVxD9F-TeIdi","trusted":true,"_uuid":"c18c97375cbdde67228b22780bff5a0230598c71","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1654866242533,"user_tz":-480,"elapsed":369,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}},"outputId":"87fa00ad-2be1-4c2f-ff0a-73c36387abe4"},"cell_type":"code","source":["model.summary()"],"execution_count":17,"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"sequential\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," vgg16 (Functional)          (None, 512)               14714688  \n","                                                                 \n"," dense (Dense)               (None, 256)               131328    \n","                                                                 \n"," dense_1 (Dense)             (None, 219)               56283     \n","                                                                 \n","=================================================================\n","Total params: 14,902,299\n","Trainable params: 14,902,299\n","Non-trainable params: 0\n","_________________________________________________________________\n"]}]},{"metadata":{"_uuid":"9e930633508ea7464b06a0e6081f3d162537de46","id":"RJsPVfsRG33l"},"cell_type":"markdown","source":["This is now the complete summary of our model that we shall use to classify the images."]},{"metadata":{"_uuid":"5a36c2ecfbc0b8dc2407be3e685ce235e420a198","id":"1WnG2ERqG33m"},"cell_type":"markdown","source":["## 3.5 ) Compiling & Training the Model"]},{"metadata":{"_uuid":"7957e2a9e323de85d99f72cf1af44f078ccc5e11","id":"_s6rYm8OG33p"},"cell_type":"markdown","source":["#### 3.5.2 ) FINE TUNING BY UNFREEZING THE LAST BLOCK OF VGG16"]},{"metadata":{"_uuid":"0deafdf0a87be6b94cf8e34e4e69e0c525afd1b0","id":"I0rOrti0G33q"},"cell_type":"markdown","source":["In this section I have done fine tuning. To see the effect of the fine tuning I have first unfreezed the last block of the VGG16 model and have set it to trainable."]},{"metadata":{"id":"ZcwBRzYYPVx8","trusted":true,"_uuid":"1efcc1bd4b8c809998052b4edf9bfd72a7467ad9","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1654866246587,"user_tz":-480,"elapsed":4,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}},"outputId":"1fc16121-615c-4a56-f5bd-01ce87fc34eb"},"cell_type":"code","source":["for i in range (len(base_model.layers)):\n","    print (i,base_model.layers[i])\n","  \n","for layer in base_model.layers[15:]:\n","    layer.trainable=True\n","for layer in base_model.layers[0:15]:\n","    layer.trainable=False\n","  "],"execution_count":18,"outputs":[{"output_type":"stream","name":"stdout","text":["0 <keras.engine.input_layer.InputLayer object at 0x7fba92596dd0>\n","1 <keras.layers.convolutional.Conv2D object at 0x7fba8814e310>\n","2 <keras.layers.convolutional.Conv2D object at 0x7fba88153a90>\n","3 <keras.layers.pooling.MaxPooling2D object at 0x7fba801a77d0>\n","4 <keras.layers.convolutional.Conv2D object at 0x7fba801c5d90>\n","5 <keras.layers.convolutional.Conv2D object at 0x7fba801a7310>\n","6 <keras.layers.pooling.MaxPooling2D object at 0x7fba801cc890>\n","7 <keras.layers.convolutional.Conv2D object at 0x7fba801cefd0>\n","8 <keras.layers.convolutional.Conv2D object at 0x7fba88153f90>\n","9 <keras.layers.convolutional.Conv2D object at 0x7fba801cad90>\n","10 <keras.layers.pooling.MaxPooling2D object at 0x7fba8015f410>\n","11 <keras.layers.convolutional.Conv2D object at 0x7fba80162d50>\n","12 <keras.layers.convolutional.Conv2D object at 0x7fba8015f0d0>\n","13 <keras.layers.convolutional.Conv2D object at 0x7fba8016b590>\n","14 <keras.layers.pooling.MaxPooling2D object at 0x7fba80174690>\n","15 <keras.layers.convolutional.Conv2D object at 0x7fba80170390>\n","16 <keras.layers.convolutional.Conv2D object at 0x7fba80158490>\n","17 <keras.layers.convolutional.Conv2D object at 0x7fba80182750>\n","18 <keras.layers.pooling.MaxPooling2D object at 0x7fba80185710>\n","19 <keras.layers.pooling.GlobalAveragePooling2D object at 0x7fba80158390>\n"]}]},{"metadata":{"id":"U6-PRjikXAoK","trusted":true,"_uuid":"67f268c689a28c44745f42658b1937d54ea2504c","executionInfo":{"status":"ok","timestamp":1654866259296,"user_tz":-480,"elapsed":393,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}}},"cell_type":"code","source":["model.compile(optimizer=Adam(lr=1e-4),loss='categorical_crossentropy',metrics=['accuracy'])\n","\n"],"execution_count":19,"outputs":[]},{"metadata":{"id":"8HOQuHdyTfj9","trusted":true,"_uuid":"21fbf26cc0c2aab15e7c5903c2f92ef6a736c213","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1654867978448,"user_tz":-480,"elapsed":1716111,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}},"outputId":"c97a4108-f36f-40fb-810e-cfba33bc3d68"},"cell_type":"code","source":["History = model.fit_generator(datagen.flow(X,Y, batch_size=batch_size),\n","                              epochs = 100,\n","                              verbose = 1, steps_per_epoch=X.shape[0] // batch_size)"],"execution_count":20,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/100\n","17/17 [==============================] - 29s 707ms/step - loss: 5.4029 - accuracy: 0.0073\n","Epoch 2/100\n","17/17 [==============================] - 13s 732ms/step - loss: 5.2045 - accuracy: 0.0230\n","Epoch 3/100\n","17/17 [==============================] - 12s 698ms/step - loss: 4.9093 - accuracy: 0.0587\n","Epoch 4/100\n","17/17 [==============================] - 12s 693ms/step - loss: 4.5186 - accuracy: 0.0912\n","Epoch 5/100\n","17/17 [==============================] - 12s 697ms/step - loss: 4.0259 - accuracy: 0.1353\n","Epoch 6/100\n","17/17 [==============================] - 12s 702ms/step - loss: 3.4527 - accuracy: 0.2241\n","Epoch 7/100\n","17/17 [==============================] - 12s 700ms/step - loss: 3.1022 - accuracy: 0.2711\n","Epoch 8/100\n","17/17 [==============================] - 12s 698ms/step - loss: 2.6245 - accuracy: 0.3681\n","Epoch 9/100\n","17/17 [==============================] - 12s 707ms/step - loss: 2.2403 - accuracy: 0.4384\n","Epoch 10/100\n","17/17 [==============================] - 12s 696ms/step - loss: 1.9227 - accuracy: 0.5048\n","Epoch 11/100\n","17/17 [==============================] - 12s 704ms/step - loss: 1.7022 - accuracy: 0.5606\n","Epoch 12/100\n","17/17 [==============================] - 12s 703ms/step - loss: 1.4502 - accuracy: 0.6169\n","Epoch 13/100\n","17/17 [==============================] - 12s 703ms/step - loss: 1.3458 - accuracy: 0.6305\n","Epoch 14/100\n","17/17 [==============================] - 12s 706ms/step - loss: 1.1990 - accuracy: 0.6848\n","Epoch 15/100\n","17/17 [==============================] - 12s 700ms/step - loss: 1.0653 - accuracy: 0.7095\n","Epoch 16/100\n","17/17 [==============================] - 12s 706ms/step - loss: 1.0096 - accuracy: 0.7207\n","Epoch 17/100\n","17/17 [==============================] - 13s 736ms/step - loss: 0.8278 - accuracy: 0.7780\n","Epoch 18/100\n","17/17 [==============================] - 12s 701ms/step - loss: 0.7126 - accuracy: 0.8036\n","Epoch 19/100\n","17/17 [==============================] - 12s 697ms/step - loss: 0.7155 - accuracy: 0.8172\n","Epoch 20/100\n","17/17 [==============================] - 12s 740ms/step - loss: 0.6640 - accuracy: 0.8167\n","Epoch 21/100\n","17/17 [==============================] - 12s 745ms/step - loss: 0.5708 - accuracy: 0.8506\n","Epoch 22/100\n","17/17 [==============================] - 12s 702ms/step - loss: 0.4622 - accuracy: 0.8754\n","Epoch 23/100\n","17/17 [==============================] - 13s 730ms/step - loss: 0.4352 - accuracy: 0.8860\n","Epoch 24/100\n","17/17 [==============================] - 12s 700ms/step - loss: 0.4601 - accuracy: 0.8826\n","Epoch 25/100\n","17/17 [==============================] - 12s 697ms/step - loss: 0.3848 - accuracy: 0.8991\n","Epoch 26/100\n","17/17 [==============================] - 12s 743ms/step - loss: 0.3460 - accuracy: 0.9127\n","Epoch 27/100\n","17/17 [==============================] - 14s 793ms/step - loss: 0.2935 - accuracy: 0.9258\n","Epoch 28/100\n","17/17 [==============================] - 12s 745ms/step - loss: 0.3038 - accuracy: 0.9239\n","Epoch 29/100\n","17/17 [==============================] - 12s 696ms/step - loss: 0.2542 - accuracy: 0.9399\n","Epoch 30/100\n","17/17 [==============================] - 12s 694ms/step - loss: 0.3513 - accuracy: 0.9093\n","Epoch 31/100\n","17/17 [==============================] - 12s 696ms/step - loss: 0.3016 - accuracy: 0.9355\n","Epoch 32/100\n","17/17 [==============================] - 12s 701ms/step - loss: 0.2130 - accuracy: 0.9544\n","Epoch 33/100\n","17/17 [==============================] - 12s 696ms/step - loss: 0.2175 - accuracy: 0.9491\n","Epoch 34/100\n","17/17 [==============================] - 12s 745ms/step - loss: 0.1586 - accuracy: 0.9685\n","Epoch 35/100\n","17/17 [==============================] - 12s 687ms/step - loss: 0.1252 - accuracy: 0.9801\n","Epoch 36/100\n","17/17 [==============================] - 12s 695ms/step - loss: 0.1447 - accuracy: 0.9651\n","Epoch 37/100\n","17/17 [==============================] - 12s 736ms/step - loss: 0.1335 - accuracy: 0.9728\n","Epoch 38/100\n","17/17 [==============================] - 12s 692ms/step - loss: 0.1001 - accuracy: 0.9816\n","Epoch 39/100\n","17/17 [==============================] - 12s 694ms/step - loss: 0.1069 - accuracy: 0.9753\n","Epoch 40/100\n","17/17 [==============================] - 12s 696ms/step - loss: 0.1257 - accuracy: 0.9733\n","Epoch 41/100\n","17/17 [==============================] - 12s 706ms/step - loss: 0.1197 - accuracy: 0.9762\n","Epoch 42/100\n","17/17 [==============================] - 12s 706ms/step - loss: 0.0818 - accuracy: 0.9850\n","Epoch 43/100\n","17/17 [==============================] - 12s 707ms/step - loss: 0.1668 - accuracy: 0.9583\n","Epoch 44/100\n","17/17 [==============================] - 12s 707ms/step - loss: 0.1050 - accuracy: 0.9767\n","Epoch 45/100\n","17/17 [==============================] - 14s 774ms/step - loss: 0.0825 - accuracy: 0.9859\n","Epoch 46/100\n","17/17 [==============================] - 12s 704ms/step - loss: 0.0701 - accuracy: 0.9893\n","Epoch 47/100\n","17/17 [==============================] - 12s 697ms/step - loss: 0.0525 - accuracy: 0.9922\n","Epoch 48/100\n","17/17 [==============================] - 12s 710ms/step - loss: 0.0502 - accuracy: 0.9893\n","Epoch 49/100\n","17/17 [==============================] - 12s 704ms/step - loss: 0.0511 - accuracy: 0.9913\n","Epoch 50/100\n","17/17 [==============================] - 12s 703ms/step - loss: 0.0698 - accuracy: 0.9874\n","Epoch 51/100\n","17/17 [==============================] - 12s 701ms/step - loss: 0.0679 - accuracy: 0.9825\n","Epoch 52/100\n","17/17 [==============================] - 12s 701ms/step - loss: 0.0493 - accuracy: 0.9927\n","Epoch 53/100\n","17/17 [==============================] - 13s 734ms/step - loss: 0.0533 - accuracy: 0.9917\n","Epoch 54/100\n","17/17 [==============================] - 12s 700ms/step - loss: 0.0466 - accuracy: 0.9922\n","Epoch 55/100\n","17/17 [==============================] - 12s 701ms/step - loss: 0.0447 - accuracy: 0.9927\n","Epoch 56/100\n","17/17 [==============================] - 12s 699ms/step - loss: 0.0467 - accuracy: 0.9903\n","Epoch 57/100\n","17/17 [==============================] - 12s 703ms/step - loss: 0.0704 - accuracy: 0.9869\n","Epoch 58/100\n","17/17 [==============================] - 13s 734ms/step - loss: 0.0621 - accuracy: 0.9871\n","Epoch 59/100\n","17/17 [==============================] - 12s 701ms/step - loss: 0.0498 - accuracy: 0.9903\n","Epoch 60/100\n","17/17 [==============================] - 14s 806ms/step - loss: 0.0576 - accuracy: 0.9893\n","Epoch 61/100\n","17/17 [==============================] - 13s 744ms/step - loss: 0.0532 - accuracy: 0.9913\n","Epoch 62/100\n","17/17 [==============================] - 12s 700ms/step - loss: 0.0610 - accuracy: 0.9874\n","Epoch 63/100\n","17/17 [==============================] - 12s 698ms/step - loss: 0.0901 - accuracy: 0.9791\n","Epoch 64/100\n","17/17 [==============================] - 12s 703ms/step - loss: 0.0531 - accuracy: 0.9908\n","Epoch 65/100\n","17/17 [==============================] - 12s 693ms/step - loss: 0.0410 - accuracy: 0.9937\n","Epoch 66/100\n","17/17 [==============================] - 12s 704ms/step - loss: 0.0588 - accuracy: 0.9864\n","Epoch 67/100\n","17/17 [==============================] - 12s 699ms/step - loss: 0.0491 - accuracy: 0.9918\n","Epoch 68/100\n","17/17 [==============================] - 12s 701ms/step - loss: 0.0359 - accuracy: 0.9937\n","Epoch 69/100\n","17/17 [==============================] - 12s 707ms/step - loss: 0.0390 - accuracy: 0.9932\n","Epoch 70/100\n","17/17 [==============================] - 12s 706ms/step - loss: 0.0344 - accuracy: 0.9952\n","Epoch 71/100\n","17/17 [==============================] - 12s 704ms/step - loss: 0.0561 - accuracy: 0.9908\n","Epoch 72/100\n","17/17 [==============================] - 12s 699ms/step - loss: 0.0792 - accuracy: 0.9796\n","Epoch 73/100\n","17/17 [==============================] - 12s 698ms/step - loss: 0.0612 - accuracy: 0.9864\n","Epoch 74/100\n","17/17 [==============================] - 13s 728ms/step - loss: 0.0432 - accuracy: 0.9926\n","Epoch 75/100\n","17/17 [==============================] - 12s 696ms/step - loss: 0.0401 - accuracy: 0.9927\n","Epoch 76/100\n","17/17 [==============================] - 12s 694ms/step - loss: 0.0394 - accuracy: 0.9927\n","Epoch 77/100\n","17/17 [==============================] - 12s 693ms/step - loss: 0.0427 - accuracy: 0.9898\n","Epoch 78/100\n","17/17 [==============================] - 12s 695ms/step - loss: 0.0330 - accuracy: 0.9947\n","Epoch 79/100\n","17/17 [==============================] - 12s 696ms/step - loss: 0.0353 - accuracy: 0.9947\n","Epoch 80/100\n","17/17 [==============================] - 12s 700ms/step - loss: 0.0214 - accuracy: 0.9966\n","Epoch 81/100\n","17/17 [==============================] - 13s 729ms/step - loss: 0.0199 - accuracy: 0.9972\n","Epoch 82/100\n","17/17 [==============================] - 12s 700ms/step - loss: 0.0352 - accuracy: 0.9913\n","Epoch 83/100\n","17/17 [==============================] - 12s 698ms/step - loss: 0.0354 - accuracy: 0.9918\n","Epoch 84/100\n","17/17 [==============================] - 12s 695ms/step - loss: 0.0187 - accuracy: 0.9976\n","Epoch 85/100\n","17/17 [==============================] - 12s 703ms/step - loss: 0.0169 - accuracy: 0.9981\n","Epoch 86/100\n","17/17 [==============================] - 12s 697ms/step - loss: 0.0128 - accuracy: 0.9985\n","Epoch 87/100\n","17/17 [==============================] - 12s 703ms/step - loss: 0.0151 - accuracy: 0.9981\n","Epoch 88/100\n","17/17 [==============================] - 12s 702ms/step - loss: 0.0111 - accuracy: 0.9985\n","Epoch 89/100\n","17/17 [==============================] - 12s 705ms/step - loss: 0.0140 - accuracy: 0.9976\n","Epoch 90/100\n","17/17 [==============================] - 12s 717ms/step - loss: 0.0463 - accuracy: 0.9898\n","Epoch 91/100\n","17/17 [==============================] - 12s 713ms/step - loss: 0.0566 - accuracy: 0.9864\n","Epoch 92/100\n","17/17 [==============================] - 12s 720ms/step - loss: 0.0481 - accuracy: 0.9918\n","Epoch 93/100\n","17/17 [==============================] - 12s 711ms/step - loss: 0.0280 - accuracy: 0.9966\n","Epoch 94/100\n","17/17 [==============================] - 12s 707ms/step - loss: 0.0187 - accuracy: 0.9966\n","Epoch 95/100\n","17/17 [==============================] - 12s 700ms/step - loss: 0.0121 - accuracy: 0.9995\n","Epoch 96/100\n","17/17 [==============================] - 14s 793ms/step - loss: 0.0101 - accuracy: 0.9981\n","Epoch 97/100\n","17/17 [==============================] - 12s 702ms/step - loss: 0.0099 - accuracy: 0.9995\n","Epoch 98/100\n","17/17 [==============================] - 12s 701ms/step - loss: 0.0308 - accuracy: 0.9956\n","Epoch 99/100\n","17/17 [==============================] - 12s 702ms/step - loss: 0.0407 - accuracy: 0.9893\n","Epoch 100/100\n","17/17 [==============================] - 12s 716ms/step - loss: 0.0582 - accuracy: 0.9859\n"]}]},{"cell_type":"code","source":["# save model\n","model.save('/content/drive/MyDrive/大四(下)/機器學習/orchid/trained_model.h5')"],"metadata":{"id":"zZ3VlCE1hQew"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# getting predictions on val set.\n","pred=model.predict(x_test)\n","pred_digits=np.argmax(pred,axis=1)\n","\n","# now storing some properly as well as misclassified indexes'.\n","i=0\n","prop_class=[]\n","mis_class=[]\n","\n","for i in range(len(y_test)):\n","    if(np.argmax(y_test[i])==pred_digits[i]):\n","        prop_class.append(i)\n","\n","i=0\n","for i in range(len(y_test)):\n","    if(not np.argmax(y_test[i])==pred_digits[i]):\n","        mis_class.append(i)\n","\n","print(len(prop_class), len(mis_class))\n","print(len(prop_class)/len(y_test))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"TIr2WoVAFZLq","executionInfo":{"status":"ok","timestamp":1654868334447,"user_tz":-480,"elapsed":4515,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}},"outputId":"3647fac6-1ab5-44d6-f9b2-30a90db1f3d1"},"execution_count":21,"outputs":[{"output_type":"stream","name":"stdout","text":["544 4\n","0.9927007299270073\n"]}]},{"metadata":{"_uuid":"9545f9161aa1643df2c00753121bb87b7a7c87d6","id":"24-F92u2G33t"},"cell_type":"markdown","source":["#### Note that the validation accuracy on fine tuning by unfreezing the last block of the VGG16 model has increased to about 81% ; almost by 3% as compared to the case when we run a classifier on the top of the CNN codes in previous section."]},{"metadata":{"id":"fhEnWLenslUN","trusted":true,"_uuid":"131a4ba19320a3fde1e5a485cd1d77e2af48ae88","colab":{"base_uri":"https://localhost:8080/","height":317},"executionInfo":{"status":"ok","timestamp":1654868477191,"user_tz":-480,"elapsed":1007,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}},"outputId":"bc99c2d0-8768-4cf1-9ae4-e30dc635504c"},"cell_type":"code","source":["plt.plot(History.history['accuracy'])\n","plt.title('Model Accuracy')\n","plt.ylabel('Accuracy')\n","plt.xlabel('Epochs')\n","plt.legend(['train'])\n","# plt.show()\n","\n","plt.savefig(f\"/content/drive/MyDrive/大四(下)/機器學習/orchid/accu.png\")"],"execution_count":25,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{}}]},{"metadata":{"id":"QYuLuLAQslnF","trusted":true,"_uuid":"954611cab64452acf57fb7dd4c08c4ffc6e1812f","colab":{"base_uri":"https://localhost:8080/","height":317},"executionInfo":{"status":"ok","timestamp":1654868487890,"user_tz":-480,"elapsed":672,"user":{"displayName":"林翊婷","userId":"17064522885913402879"}},"outputId":"c475d760-bb7e-42f6-f992-0926cb8fb46d"},"cell_type":"code","source":["plt.plot(History.history['loss'])\n","plt.title('Model Loss')\n","plt.ylabel('Loss')\n","plt.xlabel('Epochs')\n","plt.legend(['train'])\n","# plt.show()\n","\n","plt.savefig(f\"/content/drive/MyDrive/大四(下)/機器學習/orchid/loss.png\")"],"execution_count":26,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{}}]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":["6KWeOmI1G33T","HVnHjj1cG33d","Nd6pizEdG33m"],"name":"team185_train","provenance":[{"file_id":"17_JXd2IRAmF-4eh43E9tFj3T13m1Njiu","timestamp":1654841329933}]},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"name":"python","version":"3.6.6","mimetype":"text/x-python","codemirror_mode":{"name":"ipython","version":3},"pygments_lexer":"ipython3","nbconvert_exporter":"python","file_extension":".py"}},"nbformat":4,"nbformat_minor":0}